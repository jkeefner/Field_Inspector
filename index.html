<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="theme-color" content="#1a1a2e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="description" content="Offline field inspection app for engineers">
    
    <title>Field Inspector</title>
    
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" sizes="192x192" href="icons/icon-192.png">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600&family=Space+Grotesk:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div id="app">
        <!-- Splash Screen -->
        <div id="splash-screen" class="splash-screen">
            <div class="splash-content">
                <div class="splash-logo">
                    <img src="icons/logo.png" alt="Keefner Mining & Geotech">
                </div>
                <h1>Field Inspector</h1>
                <p>Offline Inspection Forms</p>
                <div class="splash-loader"></div>
            </div>
        </div>

        <!-- Main Navigation -->
        <nav class="bottom-nav" id="bottom-nav">
            <button class="nav-btn active" data-view="inspections">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2"/>
                    <rect x="9" y="3" width="6" height="4" rx="1"/>
                    <path d="M9 12l2 2 4-4"/>
                </svg>
                <span>Inspections</span>
            </button>
            <button class="nav-btn" data-view="templates">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="3" width="18" height="18" rx="2"/>
                    <line x1="3" y1="9" x2="21" y2="9"/>
                    <line x1="9" y1="21" x2="9" y2="9"/>
                </svg>
                <span>Templates</span>
            </button>
            <button class="nav-btn" data-view="reports">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 00-2 2v16a2 2 0 002 2h12a2 2 0 002-2V8z"/>
                    <polyline points="14,2 14,8 20,8"/>
                    <line x1="16" y1="13" x2="8" y2="13"/>
                    <line x1="16" y1="17" x2="8" y2="17"/>
                </svg>
                <span>Reports</span>
            </button>
            <button class="nav-btn" data-view="settings">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="3"/>
                    <path d="M12 1v2m0 18v2M4.22 4.22l1.42 1.42m12.72 12.72l1.42 1.42M1 12h2m18 0h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
                </svg>
                <span>Settings</span>
            </button>
        </nav>

        <!-- Header -->
        <header class="app-header" id="app-header">
            <div class="header-left">
                <button class="back-btn hidden" id="back-btn">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="15,18 9,12 15,6"/>
                    </svg>
                </button>
                <h1 id="header-title">Inspections</h1>
            </div>
            <div class="header-right">
                <div class="sync-status" id="sync-status">
                    <span class="sync-dot offline"></span>
                    <span class="sync-text">Offline</span>
                </div>
                <button class="header-btn" id="add-btn">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"/>
                        <line x1="5" y1="12" x2="19" y2="12"/>
                    </svg>
                </button>
            </div>
        </header>

        <!-- Main Content Views -->
        <main class="main-content" id="main-content">
            
            <!-- Inspections View -->
            <section class="view active" id="view-inspections">
                <div class="view-header">
                    <div class="search-bar">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"/>
                            <line x1="21" y1="21" x2="16.65" y2="16.65"/>
                        </svg>
                        <input type="text" placeholder="Search inspections..." id="search-inspections">
                    </div>
                    <div class="filter-tabs">
                        <button class="filter-tab active" data-filter="all">All</button>
                        <button class="filter-tab" data-filter="draft">Draft</button>
                        <button class="filter-tab" data-filter="complete">Complete</button>
                    </div>
                </div>
                <div class="inspection-list" id="inspection-list">
                    <!-- Populated dynamically -->
                </div>
                <div class="empty-state" id="empty-inspections">
                    <svg viewBox="0 0 100 100" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="20" y="10" width="60" height="80" rx="4"/>
                        <line x1="30" y1="30" x2="70" y2="30"/>
                        <line x1="30" y1="45" x2="60" y2="45"/>
                        <line x1="30" y1="60" x2="50" y2="60"/>
                    </svg>
                    <h3>No Inspections Yet</h3>
                    <p>Tap + to start your first inspection</p>
                </div>
            </section>

            <!-- Templates View -->
            <section class="view" id="view-templates">
                <div class="view-header">
                    <div class="search-bar">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"/>
                            <line x1="21" y1="21" x2="16.65" y2="16.65"/>
                        </svg>
                        <input type="text" placeholder="Search templates..." id="search-templates">
                    </div>
                </div>
                <div class="template-list" id="template-list">
                    <!-- Populated dynamically -->
                </div>
                <div class="empty-state" id="empty-templates">
                    <svg viewBox="0 0 100 100" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="15" y="15" width="70" height="70" rx="4"/>
                        <line x1="15" y1="35" x2="85" y2="35"/>
                        <line x1="40" y1="35" x2="40" y2="85"/>
                    </svg>
                    <h3>No Templates Yet</h3>
                    <p>Create custom inspection templates</p>
                </div>
            </section>

            <!-- Reports View -->
            <section class="view" id="view-reports">
                <div class="view-header">
                    <div class="search-bar">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="11" cy="11" r="8"/>
                            <line x1="21" y1="21" x2="16.65" y2="16.65"/>
                        </svg>
                        <input type="text" placeholder="Search reports..." id="search-reports">
                    </div>
                </div>
                <div class="report-list" id="report-list">
                    <!-- Populated dynamically -->
                </div>
                <div class="empty-state" id="empty-reports">
                    <svg viewBox="0 0 100 100" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M25 15 L60 15 L75 30 L75 85 L25 85 Z"/>
                        <path d="M60 15 L60 30 L75 30"/>
                        <line x1="35" y1="50" x2="65" y2="50"/>
                        <line x1="35" y1="60" x2="65" y2="60"/>
                        <line x1="35" y1="70" x2="55" y2="70"/>
                    </svg>
                    <h3>No Reports Yet</h3>
                    <p>Complete inspections to generate reports</p>
                </div>
            </section>

            <!-- Settings View -->
            <section class="view" id="view-settings">
                <div class="settings-group">
                    <h3>Profile</h3>
                    <div class="setting-item">
                        <label>Inspector Name</label>
                        <input type="text" id="setting-inspector-name" placeholder="Enter your name">
                    </div>
                    <div class="setting-item">
                        <label>Company</label>
                        <input type="text" id="setting-company" placeholder="Company name">
                    </div>
                    <div class="setting-item">
                        <label>Email</label>
                        <input type="email" id="setting-email" placeholder="email@example.com">
                    </div>
                </div>
                
                <div class="settings-group">
                    <h3>App Settings</h3>
                    <div class="setting-item toggle">
                        <label>Auto-save inspections</label>
                        <input type="checkbox" id="setting-autosave" checked>
                        <span class="toggle-switch"></span>
                    </div>
                    <div class="setting-item toggle">
                        <label>Include GPS coordinates</label>
                        <input type="checkbox" id="setting-gps" checked>
                        <span class="toggle-switch"></span>
                    </div>
                    <div class="setting-item toggle">
                        <label>High quality photos</label>
                        <input type="checkbox" id="setting-hq-photos">
                        <span class="toggle-switch"></span>
                    </div>
                </div>

                <div class="settings-group">
                    <h3>Data Management</h3>
                    <div class="setting-item action">
                        <span>Export All Data</span>
                        <button class="action-btn" id="export-data-btn">Export</button>
                    </div>
                    <div class="setting-item action">
                        <span>Import Data</span>
                        <button class="action-btn" id="import-data-btn">Import</button>
                        <input type="file" id="import-file" accept=".json" hidden>
                    </div>
                    <div class="setting-item action danger">
                        <span>Clear All Data</span>
                        <button class="action-btn danger" id="clear-data-btn">Clear</button>
                    </div>
                </div>

                <div class="settings-group">
                    <h3>About</h3>
                    <div class="about-info">
                        <p><strong>Field Inspector</strong> v1.0.0</p>
                        <p>Offline inspection forms for field engineers</p>
                        <p class="storage-info" id="storage-info">Storage: Calculating...</p>
                    </div>
                </div>

                <div class="settings-group contact-section">
                    <h3>Contact</h3>
                    <div class="contact-logo">
                        <img src="icons/logo.png" alt="Keefner Mining & Geotech LLC">
                    </div>
                    <div class="contact-info">
                        <a href="mailto:John@keefnergeo.com" class="contact-item">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/>
                                <polyline points="22,6 12,13 2,6"/>
                            </svg>
                            <span>John@keefnergeo.com</span>
                        </a>
                        <a href="tel:719-480-1018" class="contact-item">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72 12.84 12.84 0 00.7 2.81 2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45 12.84 12.84 0 002.81.7A2 2 0 0122 16.92z"/>
                            </svg>
                            <span>719-480-1018</span>
                        </a>
                        <a href="https://maps.google.com/?q=13800+Trail+21.75+Sanford+CO+81151" target="_blank" class="contact-item">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0118 0z"/>
                                <circle cx="12" cy="10" r="3"/>
                            </svg>
                            <span>13800 Trail 21.75<br>Sanford, CO 81151</span>
                        </a>
                        <a href="https://sites.google.com/keefnergeo.com/keefner-mining-geotech-llc" target="_blank" class="contact-item">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"/>
                                <line x1="2" y1="12" x2="22" y2="12"/>
                                <path d="M12 2a15.3 15.3 0 014 10 15.3 15.3 0 01-4 10 15.3 15.3 0 01-4-10 15.3 15.3 0 014-10z"/>
                            </svg>
                            <span>keefnergeo.com</span>
                        </a>
                    </div>
                </div>
            </section>

            <!-- Inspection Form View -->
            <section class="view" id="view-inspection-form">
                <div class="form-container" id="inspection-form-container">
                    <!-- Populated dynamically -->
                </div>
            </section>

            <!-- Template Builder View -->
            <section class="view" id="view-template-builder">
                <div class="builder-container" id="template-builder-container">
                    <!-- Populated dynamically -->
                </div>
            </section>

            <!-- Report Detail View -->
            <section class="view" id="view-report-detail">
                <div class="report-container" id="report-detail-container">
                    <!-- Populated dynamically -->
                </div>
            </section>
        </main>

        <!-- Modal Overlay -->
        <div class="modal-overlay" id="modal-overlay">
            <div class="modal" id="modal">
                <div class="modal-header">
                    <h3 id="modal-title">Modal Title</h3>
                    <button class="modal-close" id="modal-close">&times;</button>
                </div>
                <div class="modal-content" id="modal-content">
                    <!-- Dynamic content -->
                </div>
                <div class="modal-footer" id="modal-footer">
                    <!-- Dynamic buttons -->
                </div>
            </div>
        </div>

        <!-- Toast Notifications -->
        <div class="toast-container" id="toast-container"></div>

        <!-- Photo Capture Modal -->
        <div class="camera-modal" id="camera-modal">
            <div class="camera-header">
                <button class="camera-close" id="camera-close">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
                <span>Take Photo</span>
                <button class="camera-switch" id="camera-switch">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M16 3h5v5M8 3H3v5M3 16v5h5M16 21h5v-5"/>
                        <path d="M21 3l-7 7M3 21l7-7"/>
                    </svg>
                </button>
            </div>
            <video id="camera-video" autoplay playsinline></video>
            <canvas id="camera-canvas" hidden></canvas>
            <div class="camera-controls">
                <button class="camera-capture" id="camera-capture">
                    <span class="capture-ring"></span>
                </button>
            </div>
        </div>

        <!-- Signature Pad Modal -->
        <div class="signature-modal" id="signature-modal">
            <div class="signature-header">
                <button class="signature-close" id="signature-close">Cancel</button>
                <span>Sign Here</span>
                <button class="signature-clear" id="signature-clear">Clear</button>
            </div>
            <canvas id="signature-canvas"></canvas>
            <div class="signature-footer">
                <button class="signature-save" id="signature-save">Save Signature</button>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="js/db.js"></script>
    <script src="js/templates.js"></script>
    <script src="js/inspections.js"></script>
    <script src="js/reports.js"></script>
    <script src="js/ui.js"></script>
    <script src="js/app.js"></script>
    
    <script>
        // Register Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('sw.js')
                    .then(reg => console.log('SW registered:', reg.scope))
                    .catch(err => console.error('SW registration failed:', err));
            });
        }
    </script>
</body>
</html>
